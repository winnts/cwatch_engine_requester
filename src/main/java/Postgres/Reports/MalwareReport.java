package Postgres.Reports;

import Postgres.Entity.Reports;
import org.json.JSONArray;
import org.json.JSONObject;

import java.util.List;

/**
 * Created by Andrey.Dyachenko on 16.08.16.
 */
public class MalwareReport {
    public static void getMalware(List<Reports> reportsList) {
        String domainName;
        JSONArray malware;
        System.out.println("################# MALWARE REPORT ####################");
        for (Reports reports : reportsList) {
            JSONObject reputation = new JSONObject(reports.getFieldMalwareDescription);
            System.out.println(reports.getFieldMalwareDescription);
            domainName = reputation.getString("domain");
            System.out.println("DOMAIN: " + domainName);
            malware = reputation.getJSONObject("scanned_files_suspicious").getJSONArray("files");
            for (Object files : malware) {
                JSONObject file = new JSONObject(files.toString());
                System.out.println("FILE: " + file.getString("path") + " Perms: " + file.getString("perms"));
            }
            System.out.println("##########################################");
        }
    }
}
