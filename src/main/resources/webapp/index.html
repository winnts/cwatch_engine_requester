<!DOCTYPE html>
<html lang="en">
<head>
    <script src="https://ajax.googleapis.com/ajax/libs/jquery/1.12.4/jquery.min.js"></script>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <link rel="stylesheet" href="http://maxcdn.bootstrapcdn.com/bootstrap/3.3.7/css/bootstrap.min.css">
    <script src="https://ajax.googleapis.com/ajax/libs/jquery/1.12.4/jquery.min.js"></script>
    <script src="http://maxcdn.bootstrapcdn.com/bootstrap/3.3.7/js/bootstrap.min.js"></script>
    <title>MonitorApp</title>
    <!--<link rel="stylesheet" type="text/css" href="style.css">-->
</head>
<body>

<div class="container-fluid">
    <ul class="nav nav-tabs">
        <li class="active"><a data-toggle="tab" href="#main">Main</a></li>
        <li><a data-toggle="tab" href="#reports">Reports</a></li>
    </ul>
    <div class="tab-content">
        <div id="main" class="tab-pane fade in active">
            <h6>
                <br>
                <div class="container-fluid">
                    <div class="row">
                        <div class="col-md-4" style="background-color:white;">
                            <div class="panel panel-primary">
                                <div class="panel-heading">Agents state</div>
                                <div class="panel-body">
                                    <table class="table table-condensed" id="agents">
                                        <thead>
                                        <tr>
                                            <th>#</th>
                                            <th>Hostname</th>
                                            <th>IP</th>
                                            <th>Version</th>
                                            <th>Status</th>
                                            <th>Last seen</th>
                                        </tr>
                                        </thead>
                                        <tbody id="agentsBody">
                                        </tbody>
                                    </table>
                                </div>
                            </div>
                        </div>
                        <div class="col-md-2">
                            <div class="panel panel-success">
                                <div class="panel-heading" id="appPanel">Apps on</div>
                                <div class="panel-body">
                                    <table class="table table-hover" id="applications">
                                        <thead>
                                        <tr>
                                            <th>Name</th>
                                            <th>Version</th>
                                            <th>Status</th>
                                        </tr>
                                        </thead>
                                        <tbody>
                                        </tbody>
                                    </table>
                                </div>
                            </div>
                        </div>
                        <div class="col-md-6">
                            <div class="panel panel-info">
                                <div class="panel-heading" id="licPanel">Licenses on host</div>
                                <div class="panel-body">
                                    <table class="table table-hover" id="licenses">
                                        <thead>
                                        <tr>
                                            <th>Domain</th>
                                            <th>License key</th>
                                            <th>Product</th>
                                            <th>Status</th>
                                            <th>Expired at</th>
                                        </tr>
                                        </thead>
                                        <tbody>
                                        </tbody>
                                    </table>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
                <div class="modal fade" id="repAndScans" role="dialog">
                    <div class="modal-dialog">
                        <div class="modal-content">
                            <div class="modal-header">
                                <button type="button" class="close" data-dismiss="modal">&times;</button>
                                <h4 class="modal-title" id="repandscanTitle">Reputation and Scanning results for</h4>
                            </div>
                            <div class="modal-body" id="modalBody">
                                <p id="repscandate">Reputation last scan: </p>
                                <p id="sslissues">SSL Issues: </p>
                                <p id="isblacklisted">Blacklisted: </p>
                                <p id="webinspector">WebInspector Scan: </p>
                                <p id="malwarescandate">Files last scan: </p>
                                <p id="ismalware">Malware found: </p>
                                <p id="isinjectedcode">Injected code found: </p>
                                <p id="isinsecureperms">Insecure permissions: </p>
                                <br>
                                <br>
                            <div class="container">
                                <div class="row">
                                    <div class="col-md-3">
                                        <div class="panel panel-success">
                                            <div class="panel-heading">Whitelisted IP's</div>
                                            <div class="panel-body">
                                                <table class="table table-hover" id="ipWhite">
                                                    <thead>
                                                    <tr>
                                                        <th>IP</th>
                                                    </tr>
                                                    </thead>
                                                    <tbody>
                                                    </tbody>
                                                </table>
                                            </div>
                                        </div>
                                    </div>
                                    <div class="col-md-3">
                                        <div class="panel panel-danger">
                                            <div class="panel-heading">Blacklisted IP's</div>
                                            <div class="panel-body">
                                                <table class="table table-hover" id="ipBlack">
                                                    <thead>
                                                    <tr>
                                                        <th>IP</th>
                                                    </tr>
                                                    </thead>
                                                    <tbody>
                                                    </tbody>
                                                </table>
                                            </div>
                                        </div>
                                    </div>
                                </div>
                            </div>

                            </div>

                            <div class="modal-footer">
                                <button type="button" class="btn btn-default" data-dismiss="modal">Close</button>
                            </div>
                        </div>

                    </div>
                </div>
            </h6>
        </div>
        <div id="reports" class="tab-pane fade">
            <br>
            <p>All Reports</p>
        </div>
    </div>
</div>


<script type="text/javascript" src="getAgents.js"></script>
<script type="text/javascript" src="getApplications.js"></script>
<script type="text/javascript" src="getLicByHost.js"></script>
<script type="text/javascript" src="getRepAndScans.js"></script>
<script type="text/javascript">
    var appHostId;
    var appHostName;

    tableAgents();
    var myTimer = setInterval(tableAgents, 30000);
    var myTableTimer = setInterval(function (){
    var table = document.getElementById("agents");
    if (table != null) {
        for (var i = 1; i < table.rows.length; i++) {
            for (var j = 0; j < table.rows[i].cells.length; j++)
            table.rows[i].onclick = function () {
                appHostId = this.cells[0].innerHTML;
                appHostName = this.cells[1].innerHTML;
                tableApplications(appHostId, appHostName);
                tableLicenses(appHostId, appHostName);
            };
        }
    }
    }, 1000);
    var appTimer = setInterval(function () {tableApplications(appHostId, appHostName)}, 15000);

</script>

<script type="text/javascript">
    var appDomainName;
    var myDomainTableTimer = setInterval(function (){
    var domainTable = document.getElementById("licenses");
    if (domainTable != null) {
        for (var i = 1; i < domainTable.rows.length; i++) {
            for (var j = 0; j < domainTable.rows[i].cells.length; j++)
            domainTable.rows[i].onclick = function () {
                appDomainName = this.cells[0].innerHTML;
                <!--appHostName = this.cells[1].innerHTML;-->
                <!--tableApplications(appHostId, appHostName);-->
                <!--tableLicenses(appHostId, appHostName);-->
                $('#repAndScans').modal('show');
                modalRepAndScans(appDomainName);
            };
        }
    }
    }, 1000);

</script>

</body>
</html>